var e=Object.defineProperty,t={};function r(e){return/^http(s?):/.test(e)||e.startsWith("/")}((t,r)=>{for(var n in r)e(t,n,{get:r[n],enumerable:!0})})(t,{audioClassification:()=>d,audioToAudio:()=>m,automaticSpeechRecognition:()=>p,conversational:()=>_,documentQuestionAnswering:()=>z,featureExtraction:()=>T,fillMask:()=>H,imageClassification:()=>w,imageSegmentation:()=>b,imageToImage:()=>k,imageToText:()=>h,objectDetection:()=>A,questionAnswering:()=>B,request:()=>u,sentenceSimilarity:()=>S,streamingRequest:()=>y,summarization:()=>j,tableQuestionAnswering:()=>C,tabularClassification:()=>D,tabularRegression:()=>W,textClassification:()=>I,textGeneration:()=>O,textGenerationStream:()=>q,textToImage:()=>x,textToSpeech:()=>g,tokenClassification:()=>M,translation:()=>U,visualQuestionAnswering:()=>P,zeroShotClassification:()=>$,zeroShotImageClassification:()=>E});var n=new Map,a="https://huggingface.co";async function i(e,t,i){if(r(e))return null;let o=`${e}:${t}`,s=n.get(o);if(s&&s.date<new Date(Date.now()-6e5)&&(n.delete(o),s=void 0),void 0===s){let r=await (i?.fetch??fetch)(`${a}/api/models/${e}?expand[]=pipeline_tag`,{headers:t?{Authorization:`Bearer ${t}`}:{}}).then(e=>e.json()).then(e=>e.pipeline_tag).catch(()=>null);if(!r)return null;s={task:r,date:new Date},n.set(o,{task:r,date:new Date}),n.size>1e3&&n.delete(n.keys().next().value)}return s.task}var o="https://api-inference.huggingface.co",s=null;async function c(e,t){let n;let{accessToken:i,model:c,...u}=e,{model:l}=e,{forceTask:y,includeCredentials:f,taskHint:d,...p}=t??{},g={};if(i&&(g.Authorization=`Bearer ${i}`),!l&&!s&&d){let e=await fetch(`${a}/api/tasks`);e.ok&&(s=await e.json())}if(!l&&s&&d){let e=s[d];e&&(l=e.models[0].id)}if(!l)throw Error("No model provided, and no default model found for this task");let m="data"in e&&!!e.data;m?(t?.wait_for_model&&(g["X-Wait-For-Model"]="true"),t?.use_cache===!1&&(g["X-Use-Cache"]="false"),t?.dont_load_model&&(g["X-Load-Model"]="0")):g["Content-Type"]="application/json";let w=r(l)?l:y?`${o}/pipeline/${y}/${l}`:`${o}/models/${l}`;return"string"==typeof f?n=f:"boolean"==typeof f?n=f?"include":void 0:void 0===f&&(n="same-origin"),{url:w,info:{headers:g,method:"POST",body:m?e.data:JSON.stringify({...u,options:t&&p}),credentials:n,signal:t?.signal}}}async function u(e,t){let{url:r,info:n}=await c(e,t),a=await (t?.fetch??fetch)(r,n);if(t?.retry_on_error!==!1&&503===a.status&&!t?.wait_for_model)return u(e,{...t,wait_for_model:!0});if(!a.ok){if(a.headers.get("Content-Type")?.startsWith("application/json")){let e=await a.json();if(e.error)throw Error(e.error)}throw Error("An error occurred while fetching the blob")}return a.headers.get("Content-Type")?.startsWith("application/json")?await a.json():await a.blob()}function l(){return{data:"",event:"",id:"",retry:void 0}}async function*y(e,t){var r;let n,a,i,o;let{url:s,info:u}=await c({...e,stream:!0},t),f=await (t?.fetch??fetch)(s,u);if(t?.retry_on_error!==!1&&503===f.status&&!t?.wait_for_model)return y(e,{...t,wait_for_model:!0});if(!f.ok){if(f.headers.get("Content-Type")?.startsWith("application/json")){let e=await f.json();if(e.error)throw Error(e.error)}throw Error(`Server response contains error: ${f.status}`)}if(!f.headers.get("content-type")?.startsWith("text/event-stream"))throw Error("Server does not support event stream content type, it returned "+f.headers.get("content-type"));if(!f.body)return;let d=f.body.getReader(),p=[],g=(r=function(e,t,r){let n=l(),a=new TextDecoder;return function(i,o){if(0===i.length)r?.(n),n=l();else if(o>0){let r=a.decode(i.subarray(0,o)),s=o+(32===i[o+1]?2:1),c=a.decode(i.subarray(s));switch(r){case"data":n.data=n.data?n.data+"\n"+c:c;break;case"event":n.event=c;break;case"id":e(n.id=c);break;case"retry":let u=parseInt(c,10);isNaN(u)||t(n.retry=u)}}}}(()=>{},()=>{},e=>{p.push(e)}),o=!1,function(e){void 0===n?(n=e,a=0,i=-1):n=function(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(n,e);let t=n.length,s=0;for(;a<t;){o&&(10===n[a]&&(s=++a),o=!1);let e=-1;for(;a<t&&-1===e;++a)switch(n[a]){case 58:-1===i&&(i=a-s);break;case 13:o=!0;case 10:e=a}if(-1===e)break;r(n.subarray(s,e),i),s=a,i=-1}s===t?n=void 0:0!==s&&(n=n.subarray(s),a-=s)});try{for(;;){let{done:e,value:t}=await d.read();if(e)return;for(let e of(g(t),p))if(e.data.length>0){let t=JSON.parse(e.data);if("object"==typeof t&&null!==t&&"error"in t)throw Error(t.error);yield t}p=[]}}finally{d.releaseLock()}}var f=class extends TypeError{constructor(e){super(`Invalid inference output: ${e}. Use the 'request' method with the same parameters to do a custom call with no type checking.`),this.name="InferenceOutputError"}};async function d(e,t){let r=await u(e,{...t,taskHint:"audio-classification"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e.label&&"number"==typeof e.score)))throw new f("Expected Array<{label: string, score: number}>");return r}async function p(e,t){let r=await u(e,{...t,taskHint:"automatic-speech-recognition"});if("string"!=typeof r?.text)throw new f("Expected {text: string}");return r}async function g(e,t){let r=await u(e,{...t,taskHint:"text-to-speech"});if(!(r&&r instanceof Blob))throw new f("Expected Blob");return r}async function m(e,t){let r=await u(e,{...t,taskHint:"audio-to-audio"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e.label&&"string"==typeof e.blob&&"string"==typeof e["content-type"])))throw new f("Expected Array<{label: string, blob: string, content-type: string}>");return r}async function w(e,t){let r=await u(e,{...t,taskHint:"image-classification"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e.label&&"number"==typeof e.score)))throw new f("Expected Array<{label: string, score: number}>");return r}async function b(e,t){let r=await u(e,{...t,taskHint:"image-segmentation"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e.label&&"string"==typeof e.mask&&"number"==typeof e.score)))throw new f("Expected Array<{label: string, mask: string, score: number}>");return r}async function h(e,t){let r=(await u(e,{...t,taskHint:"image-to-text"}))?.[0];if("string"!=typeof r?.generated_text)throw new f("Expected {generated_text: string}");return r}async function A(e,t){let r=await u(e,{...t,taskHint:"object-detection"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e.label&&"number"==typeof e.score&&"number"==typeof e.box.xmin&&"number"==typeof e.box.ymin&&"number"==typeof e.box.xmax&&"number"==typeof e.box.ymax)))throw new f("Expected Array<{label:string; score:number; box:{xmin:number; ymin:number; xmax:number; ymax:number}}>");return r}async function x(e,t){let r=await u(e,{...t,taskHint:"text-to-image"});if(!(r&&r instanceof Blob))throw new f("Expected Blob");return r}function v(e){if(globalThis.Buffer)return globalThis.Buffer.from(e).toString("base64");{let t=[];return e.forEach(e=>{t.push(String.fromCharCode(e))}),globalThis.btoa(t.join(""))}}async function k(e,t){let r;r=e.parameters?{...e,inputs:v(new Uint8Array(e.inputs instanceof ArrayBuffer?e.inputs:await e.inputs.arrayBuffer()))}:{accessToken:e.accessToken,model:e.model,data:e.inputs};let n=await u(r,{...t,taskHint:"image-to-image"});if(!(n&&n instanceof Blob))throw new f("Expected Blob");return n}async function E(e,t){let r={...e,inputs:{image:v(new Uint8Array(e.inputs.image instanceof ArrayBuffer?e.inputs.image:await e.inputs.image.arrayBuffer()))}},n=await u(r,{...t,taskHint:"zero-shot-image-classification"});if(!(Array.isArray(n)&&n.every(e=>"string"==typeof e.label&&"number"==typeof e.score)))throw new f("Expected Array<{label: string, score: number}>");return n}async function _(e,t){let r=await u(e,{...t,taskHint:"conversational"});if(!(Array.isArray(r.conversation.generated_responses)&&r.conversation.generated_responses.every(e=>"string"==typeof e)&&Array.isArray(r.conversation.past_user_inputs)&&r.conversation.past_user_inputs.every(e=>"string"==typeof e)&&"string"==typeof r.generated_text&&(void 0===r.warnings||Array.isArray(r.warnings)&&r.warnings.every(e=>"string"==typeof e))))throw new f("Expected {conversation: {generated_responses: string[], past_user_inputs: string[]}, generated_text: string, warnings: string[]}");return r}async function T(e,t){let r=e.model?await i(e.model,e.accessToken,t):void 0,n=await u(e,{...t,taskHint:"feature-extraction",..."sentence-similarity"===r&&{forceTask:"feature-extraction"}}),a=(e,t,r=0)=>!(r>t)&&(e.every(e=>Array.isArray(e))?e.every(e=>a(e,t,r+1)):e.every(e=>"number"==typeof e));if(!(Array.isArray(n)&&a(n,3,0)))throw new f("Expected Array<number[][][] | number[][] | number[] | number>");return n}async function H(e,t){let r=await u(e,{...t,taskHint:"fill-mask"});if(!(Array.isArray(r)&&r.every(e=>"number"==typeof e.score&&"string"==typeof e.sequence&&"number"==typeof e.token&&"string"==typeof e.token_str)))throw new f("Expected Array<{score: number, sequence: string, token: number, token_str: string}>");return r}async function B(e,t){let r=await u(e,{...t,taskHint:"question-answering"});if(!("object"==typeof r&&r&&"string"==typeof r.answer&&"number"==typeof r.end&&"number"==typeof r.score&&"number"==typeof r.start))throw new f("Expected {answer: string, end: number, score: number, start: number}");return r}async function S(e,t){let r=e.model?await i(e.model,e.accessToken,t):void 0,n=await u(e,{...t,taskHint:"sentence-similarity",..."feature-extraction"===r&&{forceTask:"sentence-similarity"}});if(!(Array.isArray(n)&&n.every(e=>"number"==typeof e)))throw new f("Expected number[]");return n}async function j(e,t){let r=await u(e,{...t,taskHint:"summarization"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e?.summary_text)))throw new f("Expected Array<{summary_text: string}>");return r?.[0]}async function C(e,t){let r=await u(e,{...t,taskHint:"table-question-answering"});if(!("string"==typeof r?.aggregator&&"string"==typeof r.answer&&Array.isArray(r.cells)&&r.cells.every(e=>"string"==typeof e)&&Array.isArray(r.coordinates)&&r.coordinates.every(e=>Array.isArray(e)&&e.every(e=>"number"==typeof e))))throw new f("Expected {aggregator: string, answer: string, cells: string[], coordinates: number[][]}");return r}async function I(e,t){let r=(await u(e,{...t,taskHint:"text-classification"}))?.[0];if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e?.label&&"number"==typeof e.score)))throw new f("Expected Array<{label: string, score: number}>");return r}async function O(e,t){let r=await u(e,{...t,taskHint:"text-generation"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e?.generated_text)))throw new f("Expected Array<{generated_text: string}>");return r?.[0]}async function*q(e,t){yield*y(e,{...t,taskHint:"text-generation"})}function L(e){return Array.isArray(e)?e:[e]}async function M(e,t){let r=L(await u(e,{...t,taskHint:"token-classification"}));if(!(Array.isArray(r)&&r.every(e=>"number"==typeof e.end&&"string"==typeof e.entity_group&&"number"==typeof e.score&&"number"==typeof e.start&&"string"==typeof e.word)))throw new f("Expected Array<{end: number, entity_group: string, score: number, start: number, word: string}>");return r}async function U(e,t){let r=await u(e,{...t,taskHint:"translation"});if(!(Array.isArray(r)&&r.every(e=>"string"==typeof e?.translation_text)))throw new f("Expected type Array<{translation_text: string}>");return r?.[0]}async function $(e,t){let r=L(await u(e,{...t,taskHint:"zero-shot-classification"}));if(!(Array.isArray(r)&&r.every(e=>Array.isArray(e.labels)&&e.labels.every(e=>"string"==typeof e)&&Array.isArray(e.scores)&&e.scores.every(e=>"number"==typeof e)&&"string"==typeof e.sequence)))throw new f("Expected Array<{labels: string[], scores: number[], sequence: string}>");return r}async function z(e,t){let r={...e,inputs:{question:e.inputs.question,image:v(new Uint8Array(e.inputs.image instanceof ArrayBuffer?e.inputs.image:await e.inputs.image.arrayBuffer()))}},n=L(await u(r,{...t,taskHint:"document-question-answering"}))?.[0];if(!("string"==typeof n?.answer&&("number"==typeof n.end||void 0===n.end)&&("number"==typeof n.score||void 0===n.score)&&("number"==typeof n.start||void 0===n.start)))throw new f("Expected Array<{answer: string, end?: number, score?: number, start?: number}>");return n}async function P(e,t){let r={...e,inputs:{question:e.inputs.question,image:v(new Uint8Array(e.inputs.image instanceof ArrayBuffer?e.inputs.image:await e.inputs.image.arrayBuffer()))}},n=(await u(r,{...t,taskHint:"visual-question-answering"}))?.[0];if(!("string"==typeof n?.answer&&"number"==typeof n.score))throw new f("Expected Array<{answer: string, score: number}>");return n}async function W(e,t){let r=await u(e,{...t,taskHint:"tabular-regression"});if(!(Array.isArray(r)&&r.every(e=>"number"==typeof e)))throw new f("Expected number[]");return r}async function D(e,t){let r=await u(e,{...t,taskHint:"tabular-classification"});if(!(Array.isArray(r)&&r.every(e=>"number"==typeof e)))throw new f("Expected number[]");return r}"undefined"!=typeof window&&window.document,"object"==typeof self&&self.constructor&&self.constructor.name;var R=class{accessToken;defaultOptions;constructor(e="",r={}){for(let[n,a]of(this.accessToken=e,this.defaultOptions=r,Object.entries(t)))Object.defineProperty(this,n,{enumerable:!1,value:(t,n)=>a({...t,accessToken:e},{...r,...n})})}endpoint(e){return new N(e,this.accessToken,this.defaultOptions)}},N=class{constructor(e,r="",n={}){for(let[a,i]of Object.entries(t))Object.defineProperty(this,a,{enumerable:!1,value:(t,a)=>i({...t,accessToken:r,model:e},{...n,...a})})}};const G=new R("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");async function Q(e){console.log("Calling inference.translation");let t=await G.audioClassification({model:"nomrom/Spencer-Translator",data:e});return console.log(t),t}const X=()=>new Promise(e=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{document.getElementById("status").innerHTML="creating media recorder...";let r=new MediaRecorder(t),n=[];r.addEventListener("dataavailable",e=>{n.push(e.data)}),document.getElementById("status").innerHTML="created media recorder",e({start:()=>{n.length=0,r.start()},stop:()=>new Promise(e=>{r.addEventListener("stop",()=>{let t=new Blob(n),r=URL.createObjectURL(t),a=new Audio(r);e({audioBlob:t,audioUrl:r,play:()=>{a.play()}})}),r.stop()})})})});let J=null;async function Z(){document.getElementById("status").innerHTML="recording...",J.start(),await new Promise(e=>setTimeout(e,2e3));let e=await J.stop();document.getElementById("status").innerHTML="predicting...";try{let t=await Q(e.audioBlob);bestScore=function(e){if(0===e.length)return null;let t=e[0];for(let r=1;r<e.length;r++)e[r].score>t.score&&(t=e[r]);return t}(t),index=t.indexOf(bestScore),console.log(bestScore),bestScore.score>.6?(document.getElementById("prediction").innerHTML=bestScore.label,document.getElementById("prediction").style.color=["green","red","blue","yellow","purple","orange"][index],document.getElementById("error").innerHTML="",function(e){if(K.speaking){console.error("speechSynthesis.speaking");return}let t=new SpeechSynthesisUtterance(e);t.onend=function(e){console.log("SpeechSynthesisUtterance.onend")},t.onerror=function(e){console.error("SpeechSynthesisUtterance.onerror")},K.speak(t)}(bestScore.label)):(document.getElementById("prediction").innerHTML="_________",document.getElementById("prediction").style.color="white",document.getElementById("error").innerHTML="confidence too low")}catch(e){console.log("Error calling audioClassification"),console.log(e),document.getElementById("error").innerHTML="error calling audio classification API"}}async function F(){for(J=await X();;)await Z()}const K=window.speechSynthesis;F();
//# sourceMappingURL=index.7e31a08e.js.map
